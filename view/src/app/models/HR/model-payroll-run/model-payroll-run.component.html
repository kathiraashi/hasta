<div class="Modal_Content" *ngIf="Type">
   <div class="Modal_Header">
      <p> Run Payroll </p>
      <span data-dismiss="modal" (click)="bsModalRef.hide()">&times;</span>
   </div>
   <div class="Model_Body">
      <div class="Model_Body">
         <div class="row">
            <div class="col-sm-6">
               <div class="view_item">
                  <div class="Static"> Employee </div>
                  <div class="dots"> : </div>
                  <div class="Data"> {{Data.Employee?.EmployeeName}}</div>
               </div>
               <div class="view_item">
                  <div class="Static"> Payroll Month </div>
                  <div class="dots"> : </div>
                  <div class="Data"> {{ Data.MonthYear | date: 'MMMM y' }}</div>
               </div>
               <div class="view_item">
                  <div class="Static"> Total No.Of Days </div>
                  <div class="dots"> : </div>
                  <div class="Data"> {{Data.No_Of_Days}}</div>
               </div>
               <div class="view_item">
                  <div class="Static"> Payable Dates </div>
                  <div class="dots"> : </div>
                  <div class="Data"> {{ Data?.No_Of_Days - Data?.No_Of_Absent - Data?.No_Of_UnPaidLeaves }}</div>
               </div>
            </div>
            <div class="col-sm-6 text-right">
               <div class="Add-More-Buttons">
                  <button (click)="Earnings_Add()" mat-raised-button color="primary"> Add More Earnings </button>
                  <button (click)="Detections_Add()" mat-raised-button color="primary"> Add More Detections </button>
               </div>
            </div>
         </div>


         <div class="row" *ngIf="_MasterDetails">
            <div class="col-sm-6">
               <h5 class="GroupHeader"> Earnings </h5>
               <div class="view_item">
                  <div class="Static"></div>
                  <div class="dots"></div>
                  <div class="Data"> <b> Assigned </b> </div>
                  <div class="Data_1"> <b> Earned </b> </div>
               </div>
               <div class="view_item">
                  <div class="Static"> Basic Pay </div>
                  <div class="dots"> : </div>
                  <div class="Data">Rs {{_MasterDetails.Basic_Pay}}</div>
                  <div *ngIf="Form.controls['Basic_Pay']" class="Data_1">Rs {{ Form.controls['Basic_Pay'].value }}</div>
               </div>
               <div class="view_item">
                  <div class="Static"> HRA </div>
                  <div class="dots"> : </div>
                  <div class="Data"> Rs {{ _calculation(_MasterDetails.HRA_Type, _MasterDetails.HRA) }} </div>
                  <div *ngIf="Form.controls['HRA']" class="Data_1">Rs {{ Form.controls['HRA'].value }}</div>
               </div>
               <div class="view_item">
                  <div class="Static"> Conveyance </div>
                  <div class="dots"> : </div>
                  <div class="Data"> Rs {{ _calculation(_MasterDetails.Conveyance_Type, _MasterDetails.Conveyance) }} </div>
                  <div *ngIf="Form.controls['Conveyance']" class="Data_1">Rs {{ Form.controls['Conveyance'].value }}</div>
               </div>
               <div class="view_item">
                  <div class="Static"> Medical Reimbursement </div>
                  <div class="dots"> : </div>
                  <div class="Data"> Rs {{ _calculation(_MasterDetails.Medical_Reimbursement_Type, _MasterDetails.Medical_Reimbursement) }} </div>
                  <div *ngIf="Form.controls['Medical_Reimbursement']" class="Data_1">Rs {{ Form.controls['Medical_Reimbursement'].value }}</div>
               </div>
               <div class="view_item">
                  <div class="Static"> Food Allowance </div>
                  <div class="dots"> : </div>
                  <div class="Data"> Rs {{ _calculation(_MasterDetails.Food_Allowance_Type, _MasterDetails.Food_Allowance) }} </div>
                  <div *ngIf="Form.controls['Food_Allowance']" class="Data_1">Rs {{ Form.controls['Food_Allowance'].value }}</div>
               </div>
               <div class="view_item">
                  <div class="Static"> Other Allowance </div>
                  <div class="dots"> : </div>
                  <div class="Data"> Rs {{ _calculation(_MasterDetails.Other_Allowance_Type, _MasterDetails.Other_Allowance) }} </div>
                  <div *ngIf="Form.controls['Other_Allowance']" class="Data_1">Rs {{ Form.controls['Other_Allowance'].value }}</div>
               </div>
            </div>
            <div class="col-sm-6">
               <h5 class="GroupHeader"> Deductions </h5>
               <div class="view_item_new">
                  <div class="Static"></div>
                  <div class="dots"></div>
                  <!-- <div class="Data"> <b> Assigned </b> </div> -->
                  <div class="Data"> <b> Deducted </b> </div>
               </div>
               <div class="view_item_new">
                  <div class="Static"> Professional Tax </div>
                  <div class="dots"> : </div>
                  <!-- <div class="Data"> Rs {{ _calculation(_MasterDetails.Professional_Tax_Type, _MasterDetails.Professional_Tax) }} </div> -->
                  <div *ngIf="Form.controls['Professional_Tax']" class="Data">Rs {{ Form.controls['Professional_Tax'].value }}</div>
               </div>
               <div class="view_item_new">
                  <div class="Static"> Provident Fund </div>
                  <div class="dots"> : </div>
                  <!-- <div class="Data"> Rs {{ _calculation(_MasterDetails.Provident_Fund_Type, _MasterDetails.Provident_Fund) }} </div> -->
                  <div *ngIf="Form.controls['Provident_Fund']" class="Data">Rs {{ Form.controls['Provident_Fund'].value }}</div>
               </div>
               <div class="view_item_new">
                  <div class="Static"> Employee State Insurance </div>
                  <div class="dots"> : </div>
                  <!-- <div class="Data"> Rs {{ _calculation(_MasterDetails.Employee_State_Insurance_Type, _MasterDetails.Employee_State_Insurance) }} </div> -->
                  <div *ngIf="Form.controls['Employee_State_Insurance']" class="Data">Rs {{ Form.controls['Employee_State_Insurance'].value }}</div>
               </div>
               <div class="view_item_new">
                  <div class="Static"> Medical Insurance </div>
                  <div class="dots"> : </div>
                  <!-- <div class="Data"> Rs {{ _calculation(_MasterDetails.Medical_Insurance_Type, _MasterDetails.Medical_Insurance) }} </div> -->
                  <div *ngIf="Form.controls['Medical_Insurance']" class="Data">Rs {{ Form.controls['Medical_Insurance'].value }}</div>
               </div>
               <div class="view_item_new">
                  <div class="Static"> TDS </div>
                  <div class="dots"> : </div>
                  <!-- <div class="Data"> Rs {{ _calculation(_MasterDetails.TDS_Type, _MasterDetails.TDS) }}  </div> -->
                  <div *ngIf="Form.controls['TDS']" class="Data">Rs {{ Form.controls['TDS'].value }}</div>
               </div>
            </div>
         </div>

         <div class="row" *ngIf="_MasterDetails">
            <div class="col-sm-6">
               <form [formGroup]="Form">
                  <div class="row" *ngIf="Form.controls['More_Earnings']['controls'].length > 0 || Form.controls['More_Detections']['controls'].length > 0 ">
                     <div class="col-sm-12">
                        <h5 class="GroupHeader"> More Earnings </h5>
                     </div>
                  </div>
                  <ng-container formArrayName="More_Earnings" >
                     <div class="row" *ngFor="let More_Earning of Form.controls['More_Earnings']['controls']; let i=index" [formGroup]="More_Earning">
                        <div class="col-sm-1 Form_Input" style="padding-right: 0px; line-height: 30px;">
                           <label> {{i + 1}} )</label>
                        </div>
                        <div class="col-sm-6 Form_Input">
                           <ng-select class="NgSelect" 
                              [items]="_EarningsList" 
                              bindLabel="Earnings_Type"
                              bindValue="_id"
                              formControlName="Earnings"
                              [searchable]="true" 
                              placeholder="Select Earnings">
                           </ng-select>
                        </div>
                        <div class="col-sm-4 Form_Input" style="padding-right: 0px;">
                           <input type="number" (change)="calculate()" formControlName="Amount" placeholder="Amount">
                        </div>
                        <div class="col-sm-1" style="padding-left: 5px;">
                           <button (click)="Remove_Earnings(i)" mat-icon-button color="warn" style="width: 25px;"> <i class="material-icons">cancel</i> </button>
                        </div>
                     </div>
                  </ng-container>
               </form>
            </div>
            <div class="col-sm-6">
               <form [formGroup]="Form">
                  <div class="row" *ngIf="Form.controls['More_Earnings']['controls'].length > 0 || Form.controls['More_Detections']['controls'].length > 0 ">
                     <div class="col-sm-12">
                        <h5 class="GroupHeader"> More Detections </h5>
                     </div>
                  </div>
                  <ng-container formArrayName="More_Detections" >
                     <div class="row" *ngFor="let More_Detection of Form.controls['More_Detections']['controls']; let i=index" [formGroup]="More_Detection">
                        <div class="col-sm-1 Form_Input" style="padding-right: 0px; line-height: 30px;">
                           <label> {{i + 1}} )</label>
                        </div>
                        <div class="col-sm-6 Form_Input">
                           <ng-select class="NgSelect" 
                              [items]="_DetectionsList" 
                              bindLabel="Detections_Type"
                              bindValue="_id"
                              formControlName="Detections"
                              [searchable]="true" 
                              placeholder="Select Detections">
                           </ng-select>
                        </div>
                        <div class="col-sm-4 Form_Input" style="padding-right: 0px;">
                           <input type="number" (change)="calculate()" formControlName="Amount" placeholder="Amount">
                        </div>
                        <div class="col-sm-1" style="padding-left: 5px;">
                           <button (click)="Remove_Detections(i)" mat-icon-button color="warn" style="width: 25px;"> <i class="material-icons">cancel</i> </button>
                        </div>
                     </div>
                  </ng-container>
               </form>
            </div>
         </div>
         <br>
         <div class="row" *ngIf="_MasterDetails">
            <div class="col-sm-6">
            </div>
            <div class="col-sm-6">
               <form [formGroup]="Form">
                  <div class="row">
                     <div class="col-sm-12">
                        <h5 class="GroupHeader"> Total </h5>
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-6 Form_Input" style="line-height: 30px; margin-bottom: 0px;">
                        <label> Total Earnings : </label>
                     </div>
                     <div class="col-sm-6 Form_Input" style="line-height: 30px; margin-bottom: 0px;">
                        <label> Rs. {{Form.controls['Total_Earning'].value}} </label>
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-6 Form_Input" style="line-height: 30px; margin-bottom: 0px;">
                        <label> Total Detection : </label>
                     </div>
                     <div class="col-sm-6 Form_Input" style="line-height: 30px; margin-bottom: 0px;">
                        <label> Rs. {{Form.controls['Total_Detection'].value}} </label>
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-6 Form_Input" style="line-height: 30px; margin-bottom: 0px;">
                        <label> Final Salary : </label>
                     </div>
                     <div class="col-sm-6 Form_Input" style="line-height: 30px; margin-bottom: 0px; ">
                        <label> Rs. {{Form.controls['Total_Salary'].value}} </label>
                     </div>
                  </div>
               </form>
            </div>
         </div>

      </div>
   </div>
   <div class="Model_Footer" *ngIf="_MasterDetails">
      <button type="button" (click)="Submit()" [disabled]="Form.status !== 'VALID' || Uploading"  mat-raised-button color="primary">
         <span *ngIf="!Uploading"> Submit </span>
         <span *ngIf="Uploading" class="UploadingBtn"> <i class="fa fa-refresh fa-spin"></i> Loading... </span>
      </button>
   </div>
</div>